#!/bin/sh

# ******************************************************************************
# ZSH Theme
# Maintained by: Andrew McBurney
# ******************************************************************************

source "/usr/local/opt/kube-ps1/share/kube-ps1.sh"

if [ -n "$INSIDE_EMACS" ] || [ -n "$SSH_CLIENT" ] || [ -n "$SSH_TTY" ]; then
  ZSH_THEME="refined"
  PS1="$(kube_ps1)"$PS1
else
  ZSH_THEME="powerlevel9k/powerlevel9k"
  POWERLEVEL9K_MODE="awesome-patched"

  # Multiline prompt
  POWERLEVEL9K_PROMPT_ON_NEWLINE=true
  POWERLEVEL9K_MULTILINE_FIRST_PROMPT_PREFIX="%{%F{249}%}\u250f"
  POWERLEVEL9K_MULTILINE_SECOND_PROMPT_PREFIX="%{%F{249}%}\u2517%{%F{default}%} "

  # DIR
  POWERLEVEL9K_SHORTEN_DIR_LENGTH=4
  POWERLEVEL9K_SHORTEN_STRATEGY="truncate_middle"
  POWERLEVEL9K_DIR_HOME_BACKGROUND="236"
  POWERLEVEL9K_DIR_HOME_FOREGROUND="039"
  POWERLEVEL9K_DIR_HOME_SUBFOLDER_BACKGROUND="236"
  POWERLEVEL9K_DIR_HOME_SUBFOLDER_FOREGROUND="039"
  POWERLEVEL9K_DIR_DEFAULT_BACKGROUND="236"
  POWERLEVEL9K_DIR_DEFAULT_FOREGROUND="039"

  # VCS
  POWERLEVEL9K_VCS_CLEAN_BACKGROUND="235"
  POWERLEVEL9K_VCS_CLEAN_FOREGROUND="039"
  POWERLEVEL9K_VCS_MODIFIED_BACKGROUND="235"
  POWERLEVEL9K_VCS_MODIFIED_FOREGROUND="039"
  POWERLEVEL9K_VCS_UNTRACKED_BACKGROUND="235"
  POWERLEVEL9K_VCS_UNTRACKED_FOREGROUND="039"

  # Status mode
  POWERLEVEL9K_STATUS_OK_BACKGROUND="236"
  POWERLEVEL9K_STATUS_OK_FOREGROUND="035"
  POWERLEVEL9K_STATUS_ERROR_BACKGROUND="236"
  POWERLEVEL9K_STATUS_ERROR_FOREGROUND="red"

  # Vim Mode
  POWERLEVEL9K_VI_MODE_INSERT_BACKGROUND="220"
  POWERLEVEL9K_VI_MODE_INSERT_FOREGROUND="235"
  POWERLEVEL9K_VI_MODE_NORMAL_BACKGROUND="236"
  POWERLEVEL9K_VI_MODE_NORMAL_FOREGROUND="039"

  # Kubernetes
  zsh_custom_kube_ps1(){
    echo -n "$(_kube_ps1_symbol)$KUBE_PS1_SEPERATOR$KUBE_PS1_CONTEXT$KUBE_PS1_DIVIDER$KUBE_PS1_NAMESPACE"
  }
  POWERLEVEL9K_CUSTOM_KUBE_PS1="zsh_custom_kube_ps1"
  POWERLEVEL9K_CUSTOM_KUBE_PS1_BACKGROUND="235"
  POWERLEVEL9K_CUSTOM_KUBE_PS1_FOREGROUND="039"

  # OS Icon
  POWERLEVEL9K_OS_ICON_BACKGROUND="236"
  POWERLEVEL9K_OS_ICON_FOREGROUND="white"

  # Status bars
  POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(dir vcs os_icon)
  POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(status custom_kube_ps1 vi_mode)
fi
